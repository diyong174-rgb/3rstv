<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>3RSTV v6</title>
  <style>
    :root {
      --bg: #0b0d12; --card: rgba(10,12,20,.55); --stroke: #21263a; --accent: #4f8cff; --fg: #e8e8ec; --muted: #9aa0a6;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; overflow: hidden; margin: 0; background: #0b0d12; color: var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

    .app { height: 100%; width: 100%; }

    /* Drawer */
    #drawer {
      position: fixed; inset: 0 auto 0 0; width: 280px; max-width: 86vw;
      background: linear-gradient(180deg, rgba(8,10,16,.85), rgba(12,14,22,.65));
      backdrop-filter: saturate(120%) blur(10px);
      border-right: 1px solid var(--stroke);
      transform: translateX(-100%); transition: transform .28s ease;
      display: flex; flex-direction: column; z-index: 30;
    }

    #drawer.open { transform: translateX(0); }

    .drawer-header { display: flex; align-items: center; gap: 10px; padding: 14px; border-bottom: 1px solid var(--stroke); }
    .drawer-header img { width: 28px; height: 28px; }
    .search { padding: 12px 14px; border-bottom: 1px solid var(--stroke); }
    .search input {
      width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid #2a3043;
      background: #0f1320; color: var(--fg);
    }

    .list { padding: 10px; overflow: auto; flex: 1; }
    .category { font-weight: 700; margin-top: 10px; color: var(--accent); }
    .ch {
      display: flex; gap: 10px; align-items: center; width: 100%; text-align: left;
      background: transparent; border: 1px solid transparent; padding: 8px 10px; border-radius: 12px; color: var(--fg); cursor: pointer;
    }

    .ch img { width: 40px; height: 40px; object-fit: contain; }
    .ch:hover { background: #12182a; border-color: #2a3043; opacity: 0.8; }
    .ch.active { outline: 2px solid var(--accent); background: #10182c; }
    .name { font-weight: 600; }
    .meta { font-size: 12px; color: var(--muted); }

    /* Toggle button */
    #toggle {
      position: fixed; top: 12px; left: 12px; z-index: 40;
      background: rgba(15,18,30,.65); color: var(--fg); border: 1px solid var(--stroke);
      padding: 10px 12px; border-radius: 12px; cursor: pointer;
    }

    /* Player area */
    #stage {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: radial-gradient(1200px 800px at 50% -20%, #131824 0%, #0b0d12 50%, #0b0d12 100%);
    }

    .player-wrap {
      position: relative; width: 100vw; height: 100vh; padding: 0; display: grid; place-items: center;
    }

    video, audio { width: 100%; height: 100%; outline: none; }
    #video { object-fit: contain; background: #000; }

    /* Audio view */
    #audioView { position: absolute; inset: 0; display: none; }
    .audio-bg {
      position: absolute; inset: 0; background-size: cover; background-position: center;
      filter: blur(20px) brightness(.6); transform: scale(1.1);
    }
    .audio-card {
      position: relative; z-index: 2; width: min(860px, 94%); display: grid; grid-template-columns: 140px 1fr; gap: 18px; align-items: center;
      background: rgba(10,12,20,.7); border: 1px solid var(--stroke); border-radius: 14px; padding: 16px;
    }

    .audio-art { width: 140px; height: 140px; border: 1px solid var(--stroke); border-radius: 12px; background: #0f1320 center/cover no-repeat; }
    .title { font-weight: 700; font-size: 20px; }
    .note { color: var(--muted); font-size: 13px; }
    .msg { position: absolute; bottom: 14px; left: 14px; right: 14px; text-align: center; color: var(--muted); z-index: 3; }

    /* Watermark */
    #mark { position: fixed; top: 12px; right: 12px; z-index: 20; color: rgba(255,255,255,.35); font-weight: 700; }

    /* Controls */
    .controls {
      position: fixed; bottom: 14px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px; z-index: 25; flex-wrap: wrap;
    }

    .btn {
      background: rgba(15,18,30,.7); color: var(--fg); border: 1px solid var(--stroke); padding: 8px 12px; border-radius: 10px; cursor: pointer;
    }

    .btn:hover { background: #1a2238; }

    @media (max-width: 960px) {
      #toggle { top: 10px; left: 10px; }
      .audio-card { grid-template-columns: 1fr; text-align: center; }
      .audio-art { margin: 0 auto; }
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.14/dist/hls.min.js"></script>
</head>
<body>
  <div class="app">
    <!-- Drawer -->
    <aside id="drawer" aria-label="Channel drawer">
      <div class="drawer-header">
        <img src="https://i.ibb.co/r2B9MXnj/3RSTV.jpg" alt="logo">
      </div>
      <div class="search"><input id="q" placeholder="Search channels‚Ä¶ (e.g., radio, movie)"></div>
      <div class="list" id="list"></div>
    </aside>

    <!-- Toggle -->
    <button id="toggle">‚ò∞ Channels</button>

    <!-- Stage -->
    <main id="stage">
      <div id="mark">3RSTV</div>
      <div class="player-wrap">
        <video id="video" playsinline controls></video>

        <!-- Audio pretty view -->
        <div id="audioView">
          <div class="audio-bg" id="audioBg"></div>
          <div class="audio-card">
            <div class="audio-art" id="audioArt"></div>
            <div>
              <div class="title" id="audioTitle">Now Playing</div>
              <div class="note">High-quality radio stream</div>
              <audio id="audio" controls></audio>
            </div>
          </div>
        </div>

        <div class="msg" id="message"></div>
      </div>

      <!-- Quick controls -->
      <div class="controls">
        <button class="btn" id="playBtn">‚ñ∂ Play</button>
        <button class="btn" id="pauseBtn">‚è∏ Pause</button>
        <button class="btn" id="muteBtn">üîá Mute</button>
        <button class="btn" id="fsBtn">‚õ∂ Fullscreen</button>
      </div>
    </main>
  </div>

  <script>
    // Disable Ctrl+U
    document.addEventListener('keydown', function(event) {
      if (event.ctrlKey && event.key === 'u') {
        event.preventDefault();
        alert('Viewing source is disabled.');
      }
    });

    // List of channels grouped by category
    const channels = {
         CABLE: [
  { name: '3RsTV', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210631/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: '' },
  { name: '3rsSinePinoy', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210267/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: '' },	 	   
  { name: 'STAR TELEVISION', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210731/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: '' }, 
  { name: 'ATBS', url: 'https://live20.bozztv.com/akamaissh101/ssh101/atbsch21/playlist.m3u8', type: 'hls', logo: '' },
  { name: 'PINAS TV', url: 'https://live20.bozztv.com/akamaissh101/ssh101/pinastv/playlist.m3u8', type: 'hls', logo: '' },	 
  { name: 'JUZT-TV BOX', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210639/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: '' }, 
  { name: 'STAR MOVIES', url: 'https://live.dinesh29.com.np/stream/jiotvplus/starmovies/stream_0.m3u8?uid=634350630', type: 'hls', logo: '' }, 
  { name: 'SONY PIX', url: 'https://topsports.watch/sonyliv/stream.php?id=sony-pix-hd&format=.m3u8', type: 'hls', logo: '' }, 
  { name: 'STAR GOLD THRILLS', url: 'https://live.dinesh29.com.np/stream/jiotvplus/stargoldthrills/stream_0.m3u8?uid=2410432009', type: 'hls', logo: '' }, 		   
  { name: 'Blast Movies', url: 'https://amg19223-amg19223c7-amgplt0351.playout.now3.amagi.tv/playlist/amg19223-amg19223c7-amgplt0351/playlist.m3u8', type: 'hls', logo: '' },
  { name: 'TELERADYO', url: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-teleradyo-dash-abscbnono/index.mpd', keyId: '47c093e0c9fd4f80839a0337da3dd876', key: '50547394045b3d047dc7d92f57b5fb33', type: 'mpd', logo: '' },
  { name: 'GMA PINOY TV', url: 'https://cdn-uw2-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-abscbn-gma-x7-dash-abscbnono/7c693236-e0c1-40a3-8bd0-bb25e43f5bfc/index.mpd', type: 'mpd', logo: '' },
  { name: 'CINEMO GLOBAL', url: 'https://d1bail49udbz1k.cloudfront.net/out/v1/3a895f368f4a467c9bca0962559efc19/index.mpd', type: 'mpd', logo: '' },
  { name: 'CINEMA ONE', url: 'https://d9rpesrrg1bdi.cloudfront.net/out/v1/93b9db7b231d45f28f64f29b86dc6c65/index.mpd', type: 'mpd', logo: '' },
  { name: 'CINEMO', url: 'https://d1bail49udbz1k.cloudfront.net/out/v1/3a895f368f4a467c9bca0962559efc19/index.mpd', type: 'mpd', logo: '' },
  { name: 'SINEMANILA', url: 'https://live20.bozztv.com/giatv/giatv-sinemanila/sinemanila/chunks.m3u8', type: 'hls', logo: '' },
   { name: 'Gma7', url: 'https://conv.iyadtv.workers.dev/gma7x/stream.mpd', keyId: '31363231383438333031323033393138', key: '38694e34324d543478316b7455753437', type: 'mpd', logo: '' },
   { name: 'GTV', url: 'https://tinyurl.com/GMA-Kapuso', type: 'hls', logo: '' }, 
  { name: 'KAPAMILYA', url: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/index.mpd', keyId: 'bd17afb5dc9648a39be79ee3634dd4b8', key: '3ecf305d54a7729299b93a3d69c02ea5', type: 'mpd', logo: '' },
  { name: 'A2Z', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_a2z/default/index.mpd', keyId: 'f703e4c8ec9041eeb5028ab4248fa094', key: 'c22f2162e176eee6273a5d0b68d19530', type: 'mpd', logo: '' },
  { name: 'RPTV', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cnn_rptv_prod_hd/default/index.mpd', keyId: '1917f4caf2364e6d9b1507326a85ead6', key: 'a1340a251a5aa63a9b0ea5d9d7f67595', type: 'mpd', logo: '' },
  { name: '*TV5', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/tv5_hd/default1/index.mpd', keyId: '2615129ef2c846a9bbd43a641c7303ef', key: '07c7f996b1734ea288641a68e1cfdc4d', type: 'mpd', logo: '' },
  { name: 'PBARUSH', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_pbarush_hd1/default/index.mpd', keyId: '76dc29dd87a244aeab9e8b7c5da1e5f3', key: '95b2f2ffd4e14073620506213b62ac82', type: 'mpd', logo: '' },
  { name: 'ONEPH', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/oneph_sd/default/index.mpd', keyId: '92834ab4a7e1499b90886c5d49220e46', key: 'a7108d9a6cfcc1b7939eb111daf09ab3', type: 'mpd', logo: '' },
  { name: 'PBO', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/pbo_sd/default/index.mpd', keyId: 'dcbdaaa6662d4188bdf97f9f0ca5e830', key: '31e752b441bd2972f2b98a4b1bc1c7a1', type: 'mpd', logo: '' },
  { name: 'VIVACINEMA', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/viva_sd/default/index.mpd', keyId: '07aa813bf2c147748046edd930f7736e', key: '3bd6688b8b44e96201e753224adfc8fb', type: 'mpd', logo: '' },
  { name: 'CINEMAX', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_cinemax/default/index.mpd', keyId: 'b207c44332844523a3a3b0469e5652d7', key: 'fe71aea346db08f8c6fbf0592209f955', type: 'mpd', logo: '' },
  { name: 'HBO', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbohd/default/index.mpd', keyId: 'd47ebabf7a21430b83a8c4b82d9ef6b1', key: '54c213b2b5f885f1e0290ee4131d425b', type: 'mpd', logo: '' },
  { name: 'HBO FAMILY', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbofam/default/index.mpd', keyId: '872910c843294319800d85f9a0940607', key: 'f79fd895b79c590708cf5e8b5c6263be', type: 'mpd', logo: '' },
  { name: 'HBO HITS', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbohits/default1/index.mpd', keyId: 'b04ae8017b5b4601a5a0c9060f6d5b7d', key: 'a8795f3bdb8a4778b7e888ee484cc7a1', type: 'mpd', logo: '' },
  { name: 'HBO SIGNATURE', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbosign/default/index.mpd', keyId: 'a06ca6c275744151895762e0346380f5', key: '559da1b63eec77b5a942018f14d3f56f', type: 'mpd', logo: '' },
  { name: 'HITS MOVIES', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_hitsmovies/default/index.mpd', keyId: '14439a1b7afc4527bb0ebc51cf11cbc1', key: '92b0287c7042f271b266cc11ab7541f1', type: 'mpd', logo: '' },
  { name: 'ROCK ACTION', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_rockextreme/default/index.mpd', keyId: '0f852fb8412b11edb8780242ac120002', key: '4cbc004d8c444f9f996db42059ce8178', type: 'mpd', logo: '' },
  { name: 'ROCK ENTERTAINMENT', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_rockentertainment/default/index.mpd', keyId: 'e4ee0cf8ca9746f99af402ca6eed8dc7', key: 'be2a096403346bc1d0bb0f812822bb62', type: 'mpd', logo: '' },
  { name: 'NBA TV PH', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cgnl_nba/default/index.mpd', keyId: 'f36eed9e95f140fabbc88a08abbeafff', key: '0125600d0eb13359c28bdab4a2ebe75a', type: 'mpd', logo: '' },
  { name: 'CARTOON NETWORK', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cartoonnetworkhd/default/index.mpd', keyId: 'a2d1f552ff9541558b3296b5a932136b', key: 'cdd48fa884dc0c3a3f85aeebca13d444', type: 'mpd', logo: '' },
  { name: 'MOONBUG KIDS', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_moonbug_kids_sd/default/index.mpd', keyId: '0bf00921bec94a65a124fba1ef52b1cd', key: '0f1488487cbe05e2badc3db53ae0f29f', type: 'mpd', logo: '' },
  { name: 'NICK JR', url: 'https://qp-pldt-live-grp-12-prod.akamaized.net/out/u/dr_nickjr.mpd', keyId: 'bab5c11178b646749fbae87962bf5113', key: '0ac679aad3b9d619ac39ad634ec76bc8', type: 'mpd', logo: '' },
  { name: 'NICKELODEON', url: 'https://qp-pldt-live-grp-11-prod.akamaized.net/out/u/dr_nickelodeon.mpd', keyId: '9ce58f37576b416381b6514a809bfd8b', key: 'f0fbb758cdeeaddfa3eae538856b4d72', type: 'mpd', logo: '' },
  { name: 'HITS HD', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/hits_hd1/default/index.mpd', keyId: 'dac605bc197e442c93f4f08595a95100', key: '975e27ffc1b7949721ee3ccb4b7fd3e5', type: 'mpd', logo: '' },
  { name: 'HITS MOVIES', url: 'https://qp-pldt-live-grp-12-prod.akamaized.net/out/u/dr_hitsmovies.mpd', keyId: 'f56b57b32d7e4b2cb21748c0b56761a7', key: '3df06a89aa01b32655a77d93e09e266f', type: 'mpd', logo: '' },
  { name: 'HITS NOW', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hitsnow/default/index.mpd', keyId: '14439a1b7afc4527bb0ebc51cf11cbc1', key: '92b0287c7042f271b266cc11ab7541f1', type: 'mpd', logo: '' },
  { name: 'One PH', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/oneph_sd/default/index.mpd', type: 'mpd', keyId: '92834ab4a7e1499b90886c5d49220e46', key: 'a7108d9a6cfcc1b7939eb111daf09ab3', logo: '' },
  { name: 'BuKO', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_buko_sd/default/index.mpd', type: 'mpd', keyId: 'd273c085f2ab4a248e7bfc375229007d', key: '7932354c3a84f7fc1b80efa6bcea0615', logo: '' },
  { name: 'SARI-SARI', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_sarisari/default/index.mpd', type: 'mpd', keyId: '0a7ab3612f434335aa6e895016d8cd2d', key: 'b21654621230ae21714a5cab52daeb9d', logo: '' },
  { name: 'PTV4', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_ptv4_sd/default/index.mpd', type: 'mpd', keyId: '71a130a851b9484bb47141c8966fb4a3', key: 'ad1f003b4f0b31b75ea4593844435600', logo: '' },
  { name: 'One Sports', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_onesports_hd/default/index.mpd', type: 'mpd', keyId: '53c3bf2eba574f639aa21f2d4409ff11', key: '3de28411cf08a64ea935b9578f6d0edd', logo: '' },
  { name: 'One News', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/onenews_hd1/default/index.mpd', type: 'mpd', keyId: 'd39eb201ae494a0b98583df4d110e8dd', key: '6797066880d344422abd3f5eda41f45f', logo: '' },
  { name: 'Bilyonaryo Channel', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/bilyonaryoch/default1/index.mpd', type: 'mpd', keyId: '227ffaf09bec4a889e0e0988704d52a2', key: 'b2d0dce5c486891997c1c92ddaca2cd2', logo: '' },
  { name: 'tvN Movies Pinoy', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_tvnmovie/default/index.mpd', type: 'mpd', keyId: '2e53f8d8a5e94bca8f9a1e16ce67df33', key: '3471b2464b5c7b033a03bb8307d9fa35', logo: '' },
  { name: 'TMC', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_tagalogmovie/default/index.mpd', type: 'mpd', keyId: '96701d297d1241e492d41c397631d857', key: 'ca2931211c1a261f082a3a2c4fd9f91b', logo: '' },
  { name: 'Tap Movies', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_tapmovies_hd1/default/index.mpd', type: 'mpd', keyId: '71cbdf02b595468bb77398222e1ade09', key: 'c3f2aa420b8908ab8761571c01899460', logo: '' },
  { name: 'DreamWorks (Tagalized)', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_dreamworks_hd1/default/index.mpd', type: 'mpd', keyId: '564b3b1c781043c19242c66e348699c5', key: 'd3ad27d7fe1f14fb1a2cd5688549fbab', logo: '' },
  { name: 'One Sports+', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_onesportsplus_hd1/default/index.mpd', type: 'mpd', keyId: '322d06e9326f4753a7ec0908030c13d8', key: '1e3e0ca32d421fbfec86feced0efefda', logo: '' },
  { name: 'Tap Sports', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_tapsports/default/index.mpd', type: 'mpd', keyId: 'eabd2d95c89e42f2b0b0b40ce4179ea0', key: '0e7e35a07e2c12822316c0dc4873903f', logo: '' },
  { name: 'TVUP!', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/tvup_prd/default/index.mpd', type: 'mpd', keyId: '83e813ccd4ca4837afd611037af02f63', key: 'a97c515dbcb5dcbc432bbd09d15afd41', logo: '' },
  { name: 'Rock Action', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_rockextreme/default/index.mpd', type: 'mpd', keyId: '0f852fb8412b11edb8780242ac120002', key: '4cbc004d8c444f9f996db42059ce8178', logo: '' },
  { name: 'Tap TV', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_taptv_sd/default/index.mpd', type: 'mpd', keyId: 'f6804251e90b4966889b7df94fdc621e', key: '55c3c014f2bd12d6bd62349658f24566', logo: '' },
  { name: 'Fashion TV', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/fashiontvhd/default/index.mpd', type: 'mpd', keyId: '971ebbe2d887476398e97c37e0c5c591', key: '472aa631b1e671070a4bf198f43da0c7', logo: '' },
  { name: 'HBO Signature', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbosign/default/index.mpd', type: 'mpd', keyId: 'a06ca6c275744151895762e0346380f5', key: '559da1b63eec77b5a942018f14d3f56f', logo: '' },
  { name: 'HITS', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/hits_hd1/default/index.mpd', type: 'mpd', keyId: 'dac605bc197e442c93f4f08595a95100', key: '975e27ffc1b7949721ee3ccb4b7fd3e5', logo: '' },
  { name: 'tvN Premium', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_tvnpre/default/index.mpd', type: 'mpd', keyId: 'e1bde543e8a140b38d3f84ace746553e', key: 'b712c4ec307300043333a6899a402c10', logo: '' },
  { name: 'History', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_historyhd/default/index.mpd', type: 'mpd', keyId: 'a7724b7ca2604c33bb2e963a0319968a', key: '6f97e3e2eb2bade626e0281ec01d3675', logo: '' },
  { name: 'Rock Entertainment', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_rockentertainment/default/index.mpd', type: 'mpd', keyId: 'e4ee0cf8ca9746f99af402ca6eed8dc7', key: 'be2a096403346bc1d0bb0f812822bb62', logo: '' },
  { name: 'Cinemax', url: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_cinemax/default/index.mpd', type: 'mpd', keyId: 'b207c44332844523a3a3b0469e5652d7', key: 'fe71aea346db08f8c6fbf0592209f955', logo: '' },
  { name: 'AXN', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2303/default_ott.mpd ', type: 'mpd', keyId: 'fd5d928f5d974ca4983f6e9295dfe410', key: '3aaa001ddc142fedbb9d5557be43792f', logo: '' },
  { name: 'Celestial Movies Pinoy', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/celmovie_pinoy_sd/default/index.mpd', type: 'mpd', keyId: '0f8537d8412b11edb8780242ac120002', key: '2ffd7230416150fd5196fd7ea71c36f3', logo: '' },
  { name: 'HITS Movies', url: 'https://qp-pldt-live-grp-12-prod.akamaized.net/out/u/dr_hitsmovies.mpd', type: 'mpd', keyId: 'f56b57b32d7e4b2cb21748c0b56761a7', key: '3df06a89aa01b32655a77d93e09e266f', logo: '' },
  { name: 'THRILL', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_thrill_sd/default/index.mpd', type: 'mpd', keyId: '928114ffb2394d14b5585258f70ed183', key: 'a82edc340bc73447bac16cdfed0a4c62', logo: '' },
  { name: 'Lotus Macao', url: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/lotusmacau_prd/default/index.mpd', type: 'mpd', keyId: '60dc692e64ea443a8fb5ac186c865a9b', key: '01bdbe22d59b2a4504b53adc2f606cc1', logo: '' },
  { name: 'France24', url: 'https://qp-pldt-live-grp-11-prod.akamaized.net/out/u/dr_france24.mpd', type: 'mpd', keyId: '257f9fdeb39d41bdb226c2ae1fbdaeb6', key: 'e80ead0f4f9d6038ab34f332713ceaa5', logo: '' },
  { name: 'tvN Movies', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2406/default_ott.mpd', type: 'mpd', keyId: '8e269c8aa32ad77eb83068312343d610', key: 'd12ccebafbba2a535d88a3087f884252', logo: '' },
  { name: 'One', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2702/default_ott.mpd', type: 'mpd', keyId: 'd8fe398c79065173fa9788f226056510', key: '45e77e6a8ba767b63cacfdb01ef2ac29', logo: '' },
  { name: 'tvN Premium', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/1001/default_ott.mpd', type: 'mpd', keyId: 'faf4d62bb898de503446c28fb1aa9210', key: '19e80ecc5d337215c64004cb49c9cb01', logo: '' },
  { name: 'K+', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/9983/default_ott.mpd', type: 'mpd', keyId: 'aa48b28bd723f91214887df6ed9fad10', key: 'b5a3a800848120c843ae0fa68c09c261', logo: '' },
  { name: 'KBS World ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2306/default_ott.mpd', type: 'mpd', keyId: '692950d39869c92af9a9ddea453c0d10', key: 'eadc626ab959255f7ab881c03d306fe2', logo: '' },
  { name: 'MTV Live', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5014/default_ott.mpd', type: 'mpd', keyId: '3ac2542a4f7be746633db07647451710', key: '22f964a6d6927ccdba482e775cdff190', logo: '' },
  { name: 'HITS Now ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5110/default_ott.mpd', type: 'mpd', keyId: 'https://ck-server.danng.me/?username=HishamKamarul&channelid=5110', key: '', logo: '' },
  { name: 'Moonbug ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5067/default_ott.mpd', type: 'mpd', keyId: 'https://ck-dash-mpd.aqfadtv.xyz/dash-ck/linear/5067', key: '', logo: '' },
  { name: 'Nick Jr', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/9982/default_ott.mpd', type: 'mpd', keyId: 'https://ck-dash-mpd.aqfadtv.xyz/dash-ck/linear/9982', key: '', logo: '' },
  { name: 'Cartoon Network (Astro)', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/509/default_ott.mpd', type: 'mpd', keyId: '3ac2542a4f7be746633db07647451710', key: '22f964a6d6927ccdba482e775cdff190', logo: '' },
  { name: 'Nickelodeon ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2511/default_ott.mpd', type: 'mpd', keyId: 'vaX3u8HkQJb3eaBhn+mIHw', key: '2FIOlqEoOrblvlOEdL+oEA', logo: '' },
  { name: 'BBC World News', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/1008/default_ott.mpd', type: 'mpd', keyId: 'd+wO6yHAeBL9fFhig2bMsw', key: 'AXZ9HCMVwOlVb0d/sfDHEA', logo: '' },
  { name: 'Channel News Asia ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/605/default_ott.mpd', type: 'mpd', keyId: 'RCdYhO45TQUIH945X/bkFQ', key: '+BKurmvluSSoGBtRLV15EA', logo: '' },
  { name: 'CNN ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2503/default_ott.mpd', type: 'mpd', keyId: 'v34bl1VcSst0VfcRsqn/Fg', key: 'G2GKKRzs5EyYRd3fxP2bEA', logo: '' },
  { name: 'CNBC Asia', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/900/default_ott.mpd', type: 'mpd', keyId: 'YCgnqHDUmGLRoj8pEpV7TA', key: 'w6OPE0BTF1mhype8XYDIEA', logo: '' },
  { name: 'Bloomberg', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5020/default_ott.mpd', type: 'mpd', keyId: 'db1343545ae25ddecf8dfa4422f35410', key: '79a044b30d64f5c37e6d45d503cbb280', logo: '' },
  { name: 'CGTN', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5019/default_ott.mpd', type: 'mpd', keyId: 'nnBhYfAvuZy2ktKWVHBJTg', key: '/GbvDuNbW6Y53A4TxfipEA', logo: '' },
  { name: 'Al Jazeera', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/2110/default_ott.mpd', type: 'mpd', keyId: 'b1fbd0874e7923f5b05929a042aa0610', key: '6c3c498113abffdf454dc935319a794d', logo: '' },
  { name: 'Adult Swim', url: 'https://a116aivottlinear-a.akamaihd.net/OTTB/pdx-nitro/live/clients/dash/enc/rwcf8uax9l/out/v1/13ccaaacbe1143e69b7732fced73f0ab/cenc.mpd', type: 'mpd', keyId: 'cc26110bb0d29d0e4452d42602846080', key: '4a2e5782e26a3e2d7dd0431205c14518', logo: '' },
  { name: 'Cartoon Network ', url: 'https://a190aivottlinear-a.akamaihd.net/OTTB/iad-nitro/live/clients/dash/enc/ampfzrmpam/out/v1/e08f3866c80040f2bc494cb48ebc7bce/cenc.mpd', type: 'mpd', keyId: '7ef57f7f3e8cf0efe4f3d5772a7cbb35', key: '0ac6d617095fbe0ca7f4c9ae72fa5f51', logo: '' },
  { name: 'YTV', url: 'https://a196aivottlinear-a.akamaihd.net/OTTB/pdx-nitro/live/clients/dash/enc/o7aqpbb6vv/out/v1/f8f6ef738ef24c4f8176d561ffb8a157/cenc.mpd', type: 'mpd', keyId: '6f0aeae5779f1dcaef23f0bfbc828220', key: '7bcef3cf93de00e3daeb190d15b1ec05', logo: '' },
  { name: 'Disney Channel', url: 'https://a77aivottepl-a.akamaihd.net/pdx-nitro/live/clients/dash/enc/zuf794yutz/out/v1/ca3534bfe4f148298b36719204d108e0/cenc.mpd', type: 'mpd', keyId: 'be9caaa813c5305e761c66ac63645901', key: '3d40f2990ec5362ca5be3a3c9bb8f8b4', logo: '' },
  { name: 'ANC', url: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-anc-global-dash-abscbnono/index.mpd', type: 'mpd', keyId: '4bbdc78024a54662854b412d01fafa16', key: '6039ec9b213aca913821677a28bd78ae', logo: '' },
  { name: 'TFC', url: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-tfcasia-dash-abscbnono/index.mpd', type: 'mpd', keyId: '9568cc84e1d944f38eac304517eab6fd', key: 'f12142af8f39b3bab79d3679d3665ebe', logo: '' },
  { name: 'ANIMAX', url: 'https://tglmp01.akamaized.net/out/v1/de55fad9216e4fe7ad8d2eed456ba1ec/manifest.mpd', type: 'mpd', keyId: 'edf1a715de9748638dd2fad75a419af2', key: '2f5a3199b26e9b693ae881af7ff864cf', logo: '' },
  { name: 'WWE Network', url: 'https://cfrt.stream.peacocktv.com/Content/CMAF_CTR-4s/Live/channel(vc106wh3yw)/master.mpd', type: 'mpd', keyId: '00208c93f4358213b52220898b962385', key: '8ae6063167228e350dd132d4a1573102', logo: '' },
  { name: 'W-Sport', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5060/default_ott.mpd', type: 'mpd', keyId: '010cbb9cf1a01ead38070730d38bc710', key: '9cd5c0d1e54c22e035d88dd3c1dfc84c', logo: '' },
  { name: 'Cbeebies', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/5093/default_ott.mpd', type: 'mpd', keyId: '50c699c444e5f80dacafc4c99667d810', key: 'de6c5feaae5f6963b4b392ddc8b6a778', logo: '' },
  { name: 'France24 ', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/9985/default_ott.mpd', type: 'mpd', keyId: '3b0c1cebd0c4518d600f52c354ed1910', key: '76d409ffc4eaa012c61d8c31bd13df5d', logo: '' },
  { name: 'Celestial Classic Movies', url: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/100/default_ott.mpd', type: 'mpd', keyId: 'a642dd4bf3ea782e19202adefb604b10', key: '3f59355e15eed1bb219ea1687d55cfbb', logo: '' },
  { name: 'Dateline', url: 'http://161.49.17.2:6610/001/2/ch00000090990000001093/manifest.mpd?JITPDRMType=Widevine&virtualDomain=001.live_hls.zte.com', type: 'mpd', keyId: '002029fcdaae2385eedf0fd9332c3c90', key: '33b97956f316d0b65e9fd28888e7c7a9', logo: '' }
      ],
      YOUTUBE: [
         { name: 'FPJ', url: 'https://www.youtube.com/embed/1Z0M6MaGCHw?si=OUTQe2uZcgaHSY2Z', type: 'youtube', logo: '' },
		{ name: 'Mga Tuldok sa Laot (Full Episode) | The Atom Araullo Specials', url: 'https://www.youtube.com/embed/UpgO9awCYv0?si=X_FXnz0PRTp4ukhN', type: 'youtube', logo: '' },
		{ name: 'ROCKSTAR2 GREATEST HITS (NONSTOP) | Song Playlist', url: 'https://www.youtube.com/embed/TfRj7VGkAr0?si=IQBFretNafzXcF4N', type: 'youtube', logo: '' },
		{ name: 'ROMEO QUINONES - Alaala ng mga Lumang Musika ', url: 'https://www.youtube.com/embed/VVK0kcnN834?si=PNMtyf9OkhK_JQMZ', type: 'youtube', logo: '' },
		 { name: 'Best Songs of Roel Cortez', url: 'https://www.youtube.com/embed/EEOsjTTFF9g?si=OABDRdQTzuY-Ax1f', type: 'youtube', logo: '' },
		  ],
      RADIO: [
        { name: '106.3 Yes FM Dagupan', url: 'https://yesfmdagupan.radioca.st/;', type: 'mp3', logo: 'https://i.ibb.co/yBqNhTZN/raryo.jpg' },
  { name: '98.3 Love Radio Dagupan', url: 'https://loveradiodagupan.radioca.st/;', type: 'mp3', logo: 'https://i.ibb.co/yBqNhTZN/raryo.jpg' },
  { name: '90.7 Love Radio', url: 'https://azura.loveradio.com.ph/listen/love_radio_manila/radio.mp3', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/141/dzmb-love-radio-907-fm.fd6dd832.png' },
  { name: '95.5 Eagle FM', url: 'http://n0c.radiojar.com/yus0r2bghd3vv?rj-ttl=5&rj-tok=AAABl4NB7pwAuUwQgelXY74u7w', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/550/eagle-fm-955.31726a37.jpg' },
  { name: '96.3 Easy Rock', url: 'https://azura.easyrock.com.ph/listen/easy_rock_manila/radio.mp3', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/138/dwrk-963-easy-rock.c2c03660.png' },
  { name: '97.9 Home Radio', url: 'https://hrmanila.radioca.st/stream', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/3fFrky9eJE.jpg' },
  { name: '101.1 Yes FM', url: 'https://azura.yesfm.com.ph/listen/yes_fm_manila/radio.mp3', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/211/yes-fm-manila-1011.3596a020.png' },
  { name: '102.7 Star FM', url: 'https://stream.zeno.fm/69b1kf7q0y5tv', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/848/star-fm-manila.c6a245b5.png' },
  { name: '106.7 Energy FM', url: 'http://ph-icecast.eradioportal.com:8000/energyfm_manila', type: 'mp3', logo: 'https://static.mytuner.mobi/media/tvos_radios/PG5RgCjKLe.png' } 
      ]
    }; 

    // Render channels grouped by category
    function render(categories) {
      const elList = document.getElementById('list');
      elList.innerHTML = '';
      for (const category in categories) {
        const categoryElem = document.createElement('div');
        categoryElem.className = 'category';
        categoryElem.textContent = category;
        elList.appendChild(categoryElem);

        categories[category].forEach((ch, idx) => {
          const b = document.createElement('button');
          b.className = 'ch';
          b.innerHTML = `<img src="${ch.logo || 'https://i.ibb.co/r2B9MXnj/3RSTV.jpg'}" alt=""><div><div class="name">${ch.name}</div></div>`;
          b.addEventListener('click', () => selectChannel(ch, idx), { once: true });
          elList.appendChild(b);
        });
      }
    }

    // Drawer toggle
    const elDrawer = document.getElementById('drawer');
    const elToggle = document.getElementById('toggle');
    const elQ      = document.getElementById('q');
    const elVideo  = document.getElementById('video');
    const elAudioV = document.getElementById('audioView');
    const elAudio  = document.getElementById('audio');
    const elMsg    = document.getElementById('message');
    const elAudioBg= document.getElementById('audioBg');
    const elAudioArt=document.getElementById('audioArt');
    const elAudioTitle=document.getElementById('audioTitle');

    const btnPlay  = document.getElementById('playBtn');
    const btnPause = document.getElementById('pauseBtn');
    const btnMute  = document.getElementById('muteBtn');
    const btnFS    = document.getElementById('fsBtn');

    let hls=null, shakaPlayer=null;
    let activeIndex = -1;

    // Drawer toggle
    elToggle.onclick = () => {
      elDrawer.classList.toggle('open');
      if (elDrawer.classList.contains('open')) {
        setTimeout(() => elDrawer.classList.remove('open'), 15000);
      }
    };

    // Search channels
    elQ.addEventListener('input', () => {
      const q = elQ.value.toLowerCase().trim();
      render(Object.fromEntries(Object.entries(channels).map(([category, items]) => [category, items.filter(c => c.name.toLowerCase().includes(q))]))); 
    });

    // Function to cleanup old players
    function cleanup() {
      elMsg.textContent = '';
      elAudio.pause(); elAudio.src = ''; elAudio.load();
      elAudioV.style.display = 'none';
      if (hls) { try { hls.destroy(); } catch {} hls = null; }
      if (shakaPlayer) { 
        try { 
          shakaPlayer.destroy(); 
        } catch (e) { 
          console.warn("Shaka Player destroy error: ", e);
        }
        shakaPlayer = null; 
      }
      elVideo.pause(); elVideo.removeAttribute('src'); elVideo.load();

      // Clean up iframe for YouTube
      const iframe = document.getElementById('youtubeIframe');
      if (iframe) iframe.remove();
    }

    // Init Shaka player function
    function initShaka() {
      if (shakaPlayer) shakaPlayer.destroy();
      shakaPlayer = new shaka.Player(elVideo);
      shakaPlayer.addEventListener('error', ev => {
        console.error('Shaka error', ev);
        showError('DASH error (check URL/keys).');
      });
      return shakaPlayer;
    }

    // Select and play the channel
    async function selectChannel(ch, idx) {
      activeIndex = idx;
      render(channels); // refresh active state
      cleanup();  // Cleanup previous streams

      if (ch.type === 'hls') {
        if (Hls.isSupported()) {
          hls = new Hls();
          hls.attachMedia(elVideo);
          hls.on(Hls.Events.MEDIA_ATTACHED, () => hls.loadSource(ch.url));
          elVideo.muted = false;
          elVideo.controls = true;
          elVideo.style.display = 'block';
          try { await elVideo.play(); } catch { }
        }
      } else if (ch.type === 'mpd') {
        // Handle MPD streams with keys
        const s = initShaka();  // Re-initialize the player
        if (ch.keyId && ch.key) {
          try {
            s.configure({ drm: { clearKeys: { [ch.keyId]: ch.key } } });
          } catch (e) { console.warn('ClearKey config error', e); }
        }
        try {
          await s.load(ch.url);
          elVideo.muted = false;
          elVideo.controls = true;
          elVideo.style.display = 'block';
          try { await elVideo.play(); } catch (e) { console.warn('Autoplay blocked', e); }
        } catch (e) {
          console.error('Failed to load MPD stream:', e);
          showError('Failed to load DASH stream.');
        }
      } else if (ch.type === 'mp4') {
        elVideo.src = ch.url;
        elVideo.muted = false;
        elVideo.controls = true;
        elVideo.style.display = 'block';
        try { await elVideo.play(); } catch { }
      } else if (ch.type === 'mp3') {
        elAudio.src = ch.url;
        elAudioV.style.display = 'block';
        elAudioTitle.textContent = ch.name || 'Now Playing';
        const art = ch.logo || '';
        elAudioArt.style.backgroundImage = art ? `url(${art})` : 'none';
        elAudioBg.style.backgroundImage = art ? `url(${art})` : 'none';
        try { await elAudio.play(); } catch (e) { console.warn('Audio autoplay blocked', e); }
      } else if (ch.type === 'youtube') {
        const iframe = document.createElement('iframe');
        iframe.id = 'youtubeIframe';
        iframe.width = "100%";
        iframe.height = "100%";
        iframe.src = ch.url;
        iframe.frameborder = "0";
        iframe.allow = "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture";
        iframe.allowfullscreen = true;
        elVideo.style.display = 'none';  // Hide the video element for YouTube
        elMsg.textContent = '';  // Clear any previous messages
        document.querySelector('.player-wrap').appendChild(iframe);  // Add iframe to the player
      }
    }

    function showError(msg) {
      elMsg.textContent = msg;  // Display error message if any
    }

    // Initial render
    render(channels);

    // Set the first channel (Kapamilya) as the default selection
    selectChannel(channels.CABLE[0], 0);
  </script>	

</body>
</html>
